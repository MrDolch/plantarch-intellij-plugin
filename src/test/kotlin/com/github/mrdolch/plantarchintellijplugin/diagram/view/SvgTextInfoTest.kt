package com.github.mrdolch.plantarchintellijplugin.diagram.view

import io.kotest.core.spec.style.StringSpec
import io.kotest.matchers.collections.shouldContain

class SvgTextInfoTest : StringSpec({
  var svg =
    """<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="CLASS" height="740px" preserveAspectRatio="none" style="width:1035px;height:740px;background:#FFFFFF;" version="1.1" viewBox="0 0 1035 740" width="1035px" zoomAndPan="magnify"><title>Dependencies of PngViewerPanel</title><defs/><g><g class="title" data-source-line="23"><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="265.1455" x="378.2397" y="22.9951">Dependencies of PngViewerPanel</text></g><!--cluster com--><g class="cluster" data-entity="com" data-source-line="2" data-uid="ent0003" id="cluster_com"><path d="M8.5,43.2969 L42.0049,43.2969 A3.75,3.75 0 0 1 44.5049,45.7969 L51.5049,65.5938 L433.5,65.5938 A2.5,2.5 0 0 1 436,68.0938 L436,705.2969 A2.5,2.5 0 0 1 433.5,707.7969 L8.5,707.7969 A2.5,2.5 0 0 1 6,705.2969 L6,45.7969 A2.5,2.5 0 0 1 8.5,43.2969" fill="none" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="6" x2="51.5049" y1="65.5938" y2="65.5938"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="32.5049" x="10" y="58.292">com</text></g><!--cluster github--><g class="cluster" data-entity="github" data-source-line="2" data-uid="ent0004" id="cluster_github"><path d="M32.5,86.2969 L84.9678,86.2969 A3.75,3.75 0 0 1 87.4678,88.7969 L94.4678,108.5938 L409.5,108.5938 A2.5,2.5 0 0 1 412,111.0938 L412,681.2969 A2.5,2.5 0 0 1 409.5,683.7969 L32.5,683.7969 A2.5,2.5 0 0 1 30,681.2969 L30,88.7969 A2.5,2.5 0 0 1 32.5,86.2969" fill="none" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="30" x2="94.4678" y1="108.5938" y2="108.5938"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="51.4678" x="34" y="101.292">github</text></g><!--cluster mrdolch--><g class="cluster" data-entity="mrdolch" data-source-line="2" data-uid="ent0005" id="cluster_mrdolch"><path d="M56.5,129.2969 L121.6963,129.2969 A3.75,3.75 0 0 1 124.1963,131.7969 L131.1963,151.5938 L385.5,151.5938 A2.5,2.5 0 0 1 388,154.0938 L388,657.2969 A2.5,2.5 0 0 1 385.5,659.7969 L56.5,659.7969 A2.5,2.5 0 0 1 54,657.2969 L54,131.7969 A2.5,2.5 0 0 1 56.5,129.2969" fill="none" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="54" x2="131.1963" y1="151.5938" y2="151.5938"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="64.1963" x="58" y="144.292">mrdolch</text></g><!--cluster plantarchintellijplugin--><g class="cluster" data-entity="plantarchintellijplugin" data-source-line="2" data-uid="ent0006" id="cluster_plantarchintellijplugin"><path d="M80.5,172.2969 L256.7666,172.2969 A3.75,3.75 0 0 1 259.2666,174.7969 L266.2666,194.5938 L361.5,194.5938 A2.5,2.5 0 0 1 364,197.0938 L364,633.2969 A2.5,2.5 0 0 1 361.5,635.7969 L80.5,635.7969 A2.5,2.5 0 0 1 78,633.2969 L78,174.7969 A2.5,2.5 0 0 1 80.5,172.2969" fill="none" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="78" x2="266.2666" y1="194.5938" y2="194.5938"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="175.2666" x="82" y="187.292">plantarchintellijplugin</text></g><!--cluster diagram--><g class="cluster" data-entity="diagram" data-source-line="2" data-uid="ent0007" id="cluster_diagram"><path d="M104.5,215.2969 L170.7285,215.2969 A3.75,3.75 0 0 1 173.2285,217.7969 L180.2285,237.5938 L337.5,237.5938 A2.5,2.5 0 0 1 340,240.0938 L340,609.2969 A2.5,2.5 0 0 1 337.5,611.7969 L104.5,611.7969 A2.5,2.5 0 0 1 102,609.2969 L102,217.7969 A2.5,2.5 0 0 1 104.5,215.2969" fill="none" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="102" x2="180.2285" y1="237.5938" y2="237.5938"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="65.2285" x="106" y="230.292">diagram</text></g><!--cluster view--><g class="cluster" data-entity="view" data-source-line="2" data-uid="ent0008" id="cluster_view"><path d="M128.5,258.2969 L165.8535,258.2969 A3.75,3.75 0 0 1 168.3535,260.7969 L175.3535,280.5938 L313.5,280.5938 A2.5,2.5 0 0 1 316,283.0938 L316,585.2969 A2.5,2.5 0 0 1 313.5,587.7969 L128.5,587.7969 A2.5,2.5 0 0 1 126,585.2969 L126,260.7969 A2.5,2.5 0 0 1 128.5,258.2969" fill="none" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="126" x2="175.3535" y1="280.5938" y2="280.5938"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="36.3535" x="130" y="273.292">view</text></g><!--class DiagramEditor--><g class="entity" data-entity="DiagramEditor" data-source-line="2" data-uid="ent0002" id="entity_DiagramEditor"><rect fill="#CCCCCC" height="48" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="133.541" x="161" y="293.2969"/><ellipse cx="176" cy="309.2969" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1;"/><path d="M178.9688,314.9375 Q178.3906,315.2344 177.75,315.375 Q177.1094,315.5313 176.4063,315.5313 Q173.9063,315.5313 172.5781,313.8906 Q171.2656,312.2344 171.2656,309.1094 Q171.2656,305.9844 172.5781,304.3281 Q173.9063,302.6719 176.4063,302.6719 Q177.1094,302.6719 177.75,302.8281 Q178.4063,302.9844 178.9688,303.2813 L178.9688,306 Q178.3438,305.4219 177.75,305.1563 Q177.1563,304.875 176.5313,304.875 Q175.1875,304.875 174.5,305.9531 Q173.8125,307.0156 173.8125,309.1094 Q173.8125,311.2031 174.5,312.2813 Q175.1875,313.3438 176.5313,313.3438 Q177.1563,313.3438 177.75,313.0781 Q178.3438,312.7969 178.9688,312.2188 L178.9688,314.9375 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="101.541" x="190" y="314.1436">DiagramEditor</text><line style="stroke:#181818;stroke-width:0.5;" x1="162" x2="293.541" y1="325.2969" y2="325.2969"/><line style="stroke:#181818;stroke-width:0.5;" x1="162" x2="293.541" y1="333.2969" y2="333.2969"/></g><!--class PngViewerPanel--><g class="entity" data-entity="PngViewerPanel" data-source-line="3" data-uid="ent0009" id="entity_PngViewerPanel"><rect fill="#F1F1F1" height="48" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="144.499" x="156" y="401.2969"/><ellipse cx="171" cy="417.2969" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1;"/><path d="M173.9688,422.9375 Q173.3906,423.2344 172.75,423.375 Q172.1094,423.5313 171.4063,423.5313 Q168.9063,423.5313 167.5781,421.8906 Q166.2656,420.2344 166.2656,417.1094 Q166.2656,413.9844 167.5781,412.3281 Q168.9063,410.6719 171.4063,410.6719 Q172.1094,410.6719 172.75,410.8281 Q173.4063,410.9844 173.9688,411.2813 L173.9688,414 Q173.3438,413.4219 172.75,413.1563 Q172.1563,412.875 171.5313,412.875 Q170.1875,412.875 169.5,413.9531 Q168.8125,415.0156 168.8125,417.1094 Q168.8125,419.2031 169.5,420.2813 Q170.1875,421.3438 171.5313,421.3438 Q172.1563,421.3438 172.75,421.0781 Q173.3438,420.7969 173.9688,420.2188 L173.9688,422.9375 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="112.499" x="185" y="422.1436">PngViewerPanel</text><line style="stroke:#181818;stroke-width:0.5;" x1="157" x2="299.499" y1="433.2969" y2="433.2969"/><line style="stroke:#181818;stroke-width:0.5;" x1="157" x2="299.499" y1="441.2969" y2="441.2969"/></g><!--class PngViewerPanelKt--><g class="entity" data-entity="PngViewerPanelKt" data-source-line="4" data-uid="ent0010" id="entity_PngViewerPanelKt"><rect fill="#CCCCCC" height="48" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="159.1689" x="141.5" y="523.7969"/><ellipse cx="156.5" cy="539.7969" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1;"/><path d="M159.4688,545.4375 Q158.8906,545.7344 158.25,545.875 Q157.6094,546.0313 156.9063,546.0313 Q154.4063,546.0313 153.0781,544.3906 Q151.7656,542.7344 151.7656,539.6094 Q151.7656,536.4844 153.0781,534.8281 Q154.4063,533.1719 156.9063,533.1719 Q157.6094,533.1719 158.25,533.3281 Q158.9063,533.4844 159.4688,533.7813 L159.4688,536.5 Q158.8438,535.9219 158.25,535.6563 Q157.6563,535.375 157.0313,535.375 Q155.6875,535.375 155,536.4531 Q154.3125,537.5156 154.3125,539.6094 Q154.3125,541.7031 155,542.7813 Q155.6875,543.8438 157.0313,543.8438 Q157.6563,543.8438 158.25,543.5781 Q158.8438,543.2969 159.4688,542.7188 L159.4688,545.4375 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="127.1689" x="170.5" y="544.6436">PngViewerPanelKt</text><line style="stroke:#181818;stroke-width:0.5;" x1="142.5" x2="299.6689" y1="555.7969" y2="555.7969"/><line style="stroke:#181818;stroke-width:0.5;" x1="142.5" x2="299.6689" y1="563.7969" y2="563.7969"/></g><g class="entity" data-entity="2118180299" data-source-line="8" data-uid="ent0011" id="entity_2118180299"><rect fill="#CCCCCC" height="77.1875" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="334.3418" x="452" y="509.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="152.1885" x="543.0767" y="524.292">plantuml-1.2025.4.jar</text><line style="stroke:#181818;stroke-width:0.5;" x1="453" x2="785.3418" y1="529.5938" y2="529.5938"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="256.5186" x="458" y="546.5889">net.sourceforge.plantuml.FileFormat</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="303.2422" x="458" y="562.8857">net.sourceforge.plantuml.FileFormatOption</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="322.3418" x="458" y="579.1826">net.sourceforge.plantuml.SourceStringReader</text></g><g class="entity" data-entity="465261062" data-source-line="14" data-uid="ent0012" id="entity_465261062"><rect fill="#CCCCCC" height="60.8906" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="207.125" x="821.5" y="517.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="58.7754" x="895.6748" y="532.292">util-8.jar</text><line style="stroke:#181818;stroke-width:0.5;" x1="822.5" x2="1027.625" y1="537.5938" y2="537.5938"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="195.125" x="827.5" y="554.5889">kotlin.jvm.internal.Intrinsics</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="137.2656" x="827.5" y="570.8857">kotlin.text.Charsets</text></g><!--link DiagramEditor to PngViewerPanel--><g class="link" data-entity-1="DiagramEditor" data-entity-2="PngViewerPanel" data-source-line="18" data-uid="lnk13" id="link_DiagramEditor_PngViewerPanel"><path codeLine="18" d="M228,341.2969 C228,358.9569 228,377.2369 228,394.9769" fill="none" id="DiagramEditor-to-PngViewerPanel" style="stroke:#181818;stroke-width:1;stroke-dasharray:7,7;"/><polygon fill="#181818" points="228,400.9769,232,391.9769,228,395.9769,224,391.9769,228,400.9769" style="stroke:#181818;stroke-width:1;"/></g><!--link PngViewerPanel to 2118180299--><g class="link" data-entity-1="PngViewerPanel" data-entity-2="2118180299" data-source-line="19" data-uid="lnk14" id="link_PngViewerPanel_2118180299"><path codeLine="19" d="M300.17,448.5369 C355.34,465.5369 426.906,487.6001 491.586,507.5301" fill="none" id="PngViewerPanel-to-2118180299" style="stroke:#181818;stroke-width:1;stroke-dasharray:7,7;"/><polygon fill="#181818" points="497.32,509.2969,489.8969,502.824,492.5417,507.8245,487.5412,510.4693,497.32,509.2969" style="stroke:#181818;stroke-width:1;"/></g><!--link PngViewerPanel to 465261062--><g class="link" data-entity-1="PngViewerPanel" data-entity-2="465261062" data-source-line="20" data-uid="lnk15" id="link_PngViewerPanel_465261062"><path codeLine="20" d="M300.08,436.6869 C454.63,458.9569 804,509.2969 804,509.2969 C804,509.2969 808.928,510.8338 823.928,515.4738" fill="none" id="PngViewerPanel-to-465261062" style="stroke:#181818;stroke-width:1;stroke-dasharray:7,7;"/><polygon fill="#181818" points="829.66,517.2469,822.244,510.7659,824.8833,515.7693,819.8799,518.4086,829.66,517.2469" style="stroke:#181818;stroke-width:1;"/></g><!--link PngViewerPanel to PngViewerPanelKt--><g class="link" data-entity-1="PngViewerPanel" data-entity-2="PngViewerPanelKt" data-source-line="21" data-uid="lnk16" id="link_PngViewerPanel_PngViewerPanelKt"><path codeLine="21" d="M226.65,449.5269 C225.41,470.8669 223.9256,496.3268 222.6956,517.6468" fill="none" id="PngViewerPanel-to-PngViewerPanelKt" style="stroke:#181818;stroke-width:1;stroke-dasharray:7,7;"/><polygon fill="#181818" points="222.35,523.6369,226.8617,514.8822,222.638,518.6452,218.875,514.4214,222.35,523.6369" style="stroke:#181818;stroke-width:1;"/></g><g class="caption" data-source-line="27"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4502" x="508.5874" y="727.792">&#160;</text></g><!--SRC=[hLF1Ri8m3BtdAwBjZ4KhG73PPGnfsc5eIBk7rBGkQL8bBXkQzkzBgGPeXsdIuajYv_dvoNQqKI58xHeeYQjk2uqldD4Lj4PPLbvNP1cDeRerNKaM2bAbLmqS2DzWEJWF1R7pybPhBVI_2DUsV8qd-hMoQ9AIFV4WC9hRrgXPtfnOkiQCCiZ7-HGcK2j_8rMGUPRDi_auNonEIHz2HhF845pdDUwSBn6-qs551bVEDuh_YdjkcPpz7Rqv1JVioPOlg0hqulEYlMCoe_bPy6GspMVPU9PVwTqxDh4dzQ61latUAWEFjkSBfCCrXF6TuRvIFY27M2NDFW3S9PgTb28HKQ_fCjoKhES9f2HDjlfI22OsA9ROeYtGQi8WtKx- -77nRS09hOOTxKFdUzYJRLKi8-FQ81zRbAqpnzuHNm00]--></g></svg>"""

  "should extract positions of elements" {
    val svgTexts = collectSvgTexts(svg)

    svgTexts shouldContain SvgTextInfo("PngViewerPanel", 185.0, 408.1436, 112.499, 14.0)
  }
})